<!DOCTYPE html>
<html lang="en">
{{> fragments/html_header}}
<body>

  {{> fragments/top_bar}}

  <div class="container" style="max-width:900px;margin:20px auto;">
    <h2 style="margin:10px 0;">Trends</h2>

    <form method="get" action="/trending" style="margin:10px 0 20px;">
      <label>Days:
        <input type="number" name="days" value="{{days}}" min="1" max="90" style="width:80px;">
      </label>
      <label style="margin-left:12px;">Limit:
        <input type="number" name="limit" value="{{limit}}" min="1" max="50" style="width:80px;">
      </label>
      <button type="submit" class="btn">Refresh</button>
    </form>

    <div style="display:grid;grid-template-columns:1fr;gap:24px;">
      <!-- Trending Hashtags -->
      <section>
        <h3 style="margin:8px 0;">Top Hashtags</h3>
        {{#trendingHashtags}}
          <ul style="list-style:none;padding:0;margin:0;">
            {{#.}}
              <li style="padding:12px 0;border-bottom:1px solid #eee;">
                <!-- Pass the plain tag; your search already accepts with/without # -->
                <a href="/hashtagsearch?hashtags={{tag}}" style="font-weight:600;">#{{tag}}</a>
                <span style="opacity:.7;">— {{usageCount}} posts</span>
              </li>
            {{/.}}
          </ul>
        {{/trendingHashtags}}
        {{^trendingHashtags}}
          <div class="empty-state">No trends found for the selected window.</div>
        {{/trendingHashtags}}
      </section>

      <!-- Popular Posts -->
      <section>
        <h3 style="margin:8px 0;">Most Liked Posts</h3>
        {{#popularPosts}}
          <ul style="list-style:none;padding:0;margin:0;">
            {{#.}}
              <li style="padding:12px 0;border-bottom:1px solid #eee;">
                <div style="font-weight:600;">
                  <a href="/profile/{{userId}}">{{firstName}} {{lastName}}</a>
                  <span style="opacity:.7;font-weight:400;">— {{createdAt}}</span>
                </div>
                <div style="margin:6px 0 8px;">{{content}}</div>
                <div style="opacity:.8;">
                  {{likeCount}} · {{commentCount}} · <a href="/post/{{postId}}">Open</a>
                </div>
              </li>
            {{/.}}
          </ul>
        {{/popularPosts}}
        {{^popularPosts}}
          <div class="empty-state">No popular posts in this window.</div>
        {{/popularPosts}}
      </section>
    </div>
  </div>

  {{> fragments/footer}}
</body>
</html>
